🚧 注意该项目还在施工中现在不可用 🚧

# EvoNote - 你的可进化知识与自动化伙伴 🚀

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

欢迎来到 EvoNote 的魔法世界！✨

请忘记那些功能固定的冰冷工具，把 EvoNote 想象成一个能与你一同成长、不断“进化”的魔法伙伴。

它不仅仅是一个笔记软件，更是一个以 Markdown + Python 为核心咒语，拥有无限可能性的个人知识与自动化城堡。在这里，你的想象力是魔法的唯一边界。

---

## 🧠 EvoNote 的哲学：数据永生，功能自由

- ✍️ Markdown · 永恒的知识羊皮卷  
  EvoNote 相信，笔记是思想的沉淀，它应该像古老的羊皮卷一样，属于你并流传百年。因此，它选择 Markdown 这种开放、人类可读的纯文本格式。无论未来世界如何变迁，你的知识永远清晰、可控、属于你。

- 🐍 Python · 自由的功能魔法棒  
  EvoNote 相信，最懂你的魔法师就是你自己。因此，它选择 Python 这个强大、易学且拥有无限生态的语言作为你的“魔法棒”。在 EvoNote 中，每一个功能都是一个独立的 Python 魔法卷轴（插件）。你可以像拼乐高一样，自由组合、修改，甚至用几行 Python 代码（或者让 AI 帮你写！）创造一个全新的魔法，打造一个完全为你定制的专属城堡。

---

## ✨ 核心优势：为什么 EvoNote 与众不同？

- 🚀 无限扩展，随你进化  
  核心极简，功能皆为可插拔插件。你可以为它增添翻译、图表、AI 助手等任意“魔法”。

- 🕊️ 告别锁定，数据自由  
  所有笔记均为标准 .md 纯文本，完全掌握在你本地手中。

- 🧩 极致解耦，稳定灵活  
  插件通过全局信号总线解耦，彼此独立、安全稳定。

- 🤖 AI 友好，拥抱未来  
  Python 是 AI 时代的通用咒语，轻松把各类 AI 能力集成进你的知识工作流。

---

## 🚀 快速上手：开启你的魔法之旅

只需两步：

1) 念动咒语（安装依赖）
```bash
pip install -r requirements.txt
```

2) 开启传送门（运行 EvoNote）
```bash
python main.py
```

提示

- 首次进入若未选择任何“知识库（Vault）”，界面会显示欢迎语并禁用编辑。  
  请通过“工具栏 → 库管理”添加或切换一个库后再开始书写。
- 安全规则：禁止将“程序目录（EvoNote 安装目录）”设置为库；请选择任意你自己的文件夹作为库根目录。
- 库结构会在创建/切换时自动生成：
  - pages/：存放你的 Markdown 笔记
  - assets/：存放图片等附件
  - .EvoNotDB/：库数据库目录（包含 whoosh_index 与 index.db），已加入 .gitignore

---

## 🎮 新手任务：像玩游戏一样探索 EvoNote

欢迎来到新手村！通过几个小任务，快速掌握基本玩法。

### 任务一：召唤命令面板

在任何地方按下 Ctrl+P（macOS 为 Cmd+P），会召唤“命令面板”。这里是所有快捷魔法的入口。

- 试试看：在面板中输入“新建”，选择“文件：新建笔记”即可创建一张新的羊皮卷。

### 任务二：建立知识传送门（链接）

知识不应是孤岛，你可以用 [[页面链接]] 在笔记之间穿梭。

- 我们已为你准备了 Note A.md 与 Note B.md。打开 Note A.md，输入 [[Note B]]。  
  你会看到蓝色带下划线的链接，点击即可跳转。现在链接文本不展示 .md 后缀，补全候选也只显示“笔记名”（stem）。

- Shift+点击 [[Note B]] 可在“新窗口”中打开该笔记的独立编辑器，窗口标题即为“Note B”。  
  新窗口之间互不干扰，便于并行对照编辑。

- 若输入 [[New Note]] 并点击它（或从补全中选择后回车），系统会在当前库的 pages/ 下自动创建 pages/New Note.md，并跳转或在新窗打开（按 Shift）。

- 在输入 [[No 时，补全会基于 SQLite 的 files.stem 前缀匹配提供候选项；列表中不显示 .md。

### 任务三：创造可复用的知识结晶（内容块）

- 在 Note A.md 输入 {{这是一个重要的想法}}。  
- 当你停止输入约 250ms 后，会出现半透明浮窗，提供“全局更新/取消”操作：  
  - 全局更新：把该块在其它文件中的实例同步为当前内容  
  - 取消：撤销这次块级修改并恢复
- 在 Note B.md 输入 {{这是 开头，补全会出现同名块，选择即可复用。

---

## 🧭 库管理（工具栏）

- 打开“工具栏 → 库管理”，你可以：  
  - 添加库：选择任意文件夹作为库根目录  
  - 切换库：一键切换当前工作库，应用会自动确保 pages/ 与 assets/ 存在  
  - 移除库：可移除非当前库的记录  
  - 清空并重建索引：删除并重建 .EvoNotDB（index.db、whoosh_index）  

切换库后，应用会更新上下文并广播状态；若无库处于激活状态，将回到“无库态欢迎语”，并拦截跳转/新窗等操作。

---

## 🗺️ 城堡结构导览

```mermaid
graph TD
    A["main.py (城堡的魔法之源)"] --> B{"core (驱动城堡的心脏)"}
    B --> B1["app.py (大管家)"]
    B --> B2["plugin_manager.py (魔法卷轴管理员)"]
    B --> B3["signals.py (传声螺)"]
    B --> B4["ui_manager.py (炼金工房, 负责外观)"]
    B --> B5["command.py (命令面板基石)"]
    B --> B6["command_palette.py (命令面板 UI)"]
    B --> B7["api.py (与外界沟通的信使)"]
    B --> B8["parsing_service.py (羊皮卷阅读者)"]
    B --> B9["rendering_service.py (羊皮卷绘画者)"]

    A --> C{"services (辛勤工作的地精工坊)"}
    C --> C1["file_indexer_service.py (图书管理员)"]

    A --> D{"plugins (存放所有魔法卷轴的书架)"}
    D --> D1["editable_editor (魔法书写羽毛笔)"]
    D --> D2["completion_service.py (智慧精灵, 提供补全建议)"]
    D --> D3["file_browser_plugin.py (领地地图)"]
    D --> D4["backlink_panel.py (记忆水晶球, 显示谁提到了我)"]
    D --> D5["tool_launcher.py (工具栏)"]
    D --> D6["... (你的下一个绝妙魔法！)"]

    A --> E[".EvoNotDB (知识库数据库目录)"]
    E --> E1["index.db (知识账本)"]
    E --> E2["whoosh_index (快速检索目录)"]
```

---

## 📜 历史的篇章（更新日志）
- V0.4.5a: 这是一个关键的修复与增强版本。它彻底修复了 [[页面链接]] 的导航跳转和 {{内容块}} 的同步BUG；同时，引入了全新的“多库（Vault）管理”系统，支持创建、切换和管理多个独立的知识库。
- V0.4.5: 实现了完整的 {{内容块}} 同步修改引擎，包括修改后的UI提示、后台异步全局更新、智能合并及垃圾回收功能。
- V0.4.4 (2025-10-02) - 知识结晶：引入 {{内容块}}，实现后台索引与实时补全
- V0.4.3 (2025-10-02) - 命令面板：加入 Ctrl+P 命令面板
- V0.4.2b (2025-10-02) - 反向链接面板：查看哪些笔记提到了当前笔记
- V0.4.2a (2025-10-02) - 链接点击：编辑器内 [[页面链接]] 可点击跳转
- V0.4.1 (2025-10-02) - 智慧的低语：在输入 [[ 时提供自动补全
- V0.4.0.1 (2025-10-02) - 地基加固：修复图书管理员多个问题，重构重命名逻辑
- V0.3.2 (2025-10-01) - 羽毛笔升级：编辑器内核升级，书写体验更流畅
- V0.3.1 (2025-10-01) - 羊皮卷显影：基于 AST 的 Markdown 只读渲染
- V0.3.0 (2025-10-01) - 获得阅读能力：集成 markdown-it-py 解析
- V0.2 (2025-10-01) - 城堡骨架：可停靠的插件式 UI 系统
- V0.1 (2025-09-30) - 创世之初：微内核 + 插件的最小可行城堡

---

## 🚀 未来的史诗（路线图）

- V0.4.6（拟）：知识结晶的进一步共鸣  
  - 更细粒度的冲突合并与版本回溯
- V0.5.0（拟）：Python API 增强  
  - 更强大、更易用的插件与自动化能力
- 长远目标：  
  - 建立开放的插件生态  
  - 引入更强 AI 能力（摘要、问答、自动整理）  
  - 探索更多可能性

---

## 📄 许可协议

本项目采用 MIT License。欢迎自由使用、传承与创造。
